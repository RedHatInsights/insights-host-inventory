inv-account-integrity:
  summary: I shouldn't be able to access data from different account
  priority: critical

inv-rhsm-org_id-header:
  summary: Internal API requests from RHSM should be able to set org_id via header
  description: >
    When the identity header of an API request has "X509" type (generated by Turnpike), and the
    sender is RHSM Errata (determined by subject_dn and issuer_dn), then it is OK if the identity
    doesn't include org_id and it is set via the x-inventory-org-id header. Otherwise, this header
    should be ignored.
  links:
    - https://issues.redhat.com/browse/RHINENG-18446
    - https://redhat-internal.slack.com/archives/CQFKM031T/p1748534667650549?thread_ts=1748354023.646659&cid=CQFKM031T
  priority: high

inv-hosts-get-list:
  summary: Get list of all hosts
  description: I should be able to get list of all hosts on GET /hosts endpoint.
  priority: critical

inv-hosts-filter-by-display_name:
  summary: Filter hosts by Display Name
  description: >
    I should be able to filter hosts by their display name on GET /hosts endpoint via `display_name` parameter.
  priority: medium

inv-hosts-filter-by-fqdn:
  summary: Filter hosts by FQDN
  description: >
    I should be able to filter hosts by their hostname on GET /hosts endpoint via `fqdn` parameter.
  priority: high

inv-hosts-filter-by-hostname_or_id:
  summary: Filter hosts by FQDN, Display Name or Inventory ID
  description: >
    BE: I should be able to filter hosts by their hostname, Display Name or Inventory ID
    on GET /hosts endpoint via `hostname_or_id` parameter.
    FE: I should be able to filter hosts by "Name" filter.
  priority: critical

inv-hosts-filter-by-staleness:
  summary: Filter hosts by staleness status
  description: >
    I should be able to filter hosts by their staleness status on GET /hosts endpoint via `staleness` parameter.
    Provider parameter has to be a comma separated list of available values (default settings values):
    - fresh: hosts that have their stale_timestamp set to future
    - stale: hosts that have their stale_timestamp set to past and stale_warning_timestamp (stale_timestamp + 7 days)
             set to future
    - stale_warning: hosts that have their stale_warning_timestamp set to past and
             culled_timestamp (stale_warning_timestamp + 7 days) set to future
    The precise definitions and durations for "fresh," "stale," and "stale_warning" host staleness are configurable
    and can vary depending on the specific account settings.
  priority: critical

inv-hosts-get-specific-sp-fields:
  summary: Getting specific system_profile fields
  description: >
    I should be able to get only specific system_profile fields on GET /hosts, GET /hosts/<host_id_list>
    and GET /hosts/<host_id_list/system_profile endpoints. The format of the parameter should be:
    `fields[system_profile]=field_name` and I can provide multiple of these parameters.
  priority: high

inv-hosts-filter-by-registered_with:
  summary: Filter hosts by their source
  description: >
    I should be able to filter hosts by their source on GET /hosts endpoint via `registered_with` parameter.
    Provided parameter value has to be one of available values: insights
  priority: critical

inv-hosts-filter-by-system_type:
  summary: Filter hosts by system_type
  description: >
    I should be able to filter hosts by their source on GET /hosts endpoint via `system_type` parameter.
  priority: high

inv-hosts-filter-by-tags:
  summary: Filter hosts by tags
  description: >
    BE: I should be able to filter hosts by their tags on GET /hosts endpoint via `tags` parameter.
    Provided parameter has to be a comma separated list of tags in this format: <namespace>/<key>=<value>
    FE: I should be able to filter hosts by "Tags"/"Global tags" filter.
  priority: critical

inv-hosts-filter-by-reporter:
  summary: Filter hosts by their reporters
  description: >
    I should be able to filter hosts by checking if the provided reporter has a report in the per_reporter_staleness
  priority: high

inv-hosts-filter-by-updated:
  summary: Filter hosts by the time of last updated
  description: >
    BE: I should be able to filter hosts by their last updated time on GET /hosts endpoint
    via `updated_start` and `updated_end`  parameters.
    Provided parameter value has to be in valid timestamp format.
    UI: I should be able filter hosts by 'Last seen' filter
  priority: high

inv-hosts-filter-by-last_check_in:
  summary: Filter hosts by the time of last check-in
  description: >
    BE: I should be able to filter hosts by their last check-in time on GET /hosts endpoint
    via `last_check_in_start` and `last_check_in_end` parameters.
    Provided parameter value has to be in valid timestamp format.
    UI: I should be able filter hosts by 'Last seen' filter
  priority: high

inv-hosts-filter-by-group_name:
  summary: Filter hosts by the name of the group it is associated with
  description: >
    BE: Filter hosts by the name of the group it is associated with.
    FE: I should be able to filter hosts by "Workspace" filter.
  priority: critical

inv-hosts-get-by-sp-scalar-fields:
  summary: Filter hosts by system_profile scalar fields
  description: >
    I should be able to filter hosts by values in their system_profile fields on GET /hosts endpoint.
    The format of the parameter should be: `filter[system_profile][field_name][]=value`.
    In addition, I should be able to add comparator to the parameter in the format of
    `filter[system_profile][field_name][comparator][]=value`. Filtering without comparator should
    be the same as filtering with `eq` comparator (equality).
    I should be able to filter by all scalar fields by nil/not_nil values and by comparing by equality.
    I should also be able to filter by integer and datetime values with `gt`, `lt`, `gte` and `lte` comparators.
  priority: high

inv-hosts-filter-by-sp-sap_sids:
  summary: Filter hosts by SAP SIDs
  description: I should be able to filter hosts by their system_profile.sap_sids values
  priority: high

inv-hosts-filter-by-sp-operating_system:
  summary: Filter hosts by Operating System
  description: >
    BE: I should be able to filter hosts by their system_profile.operating_system values.
    FE: I should be able to filter hosts by "Operating system" filter.
  priority: critical

inv-hosts-filter-by-system_profile-ansible:
  summary: Filter hosts by Ansible field
  description: I should be able to filter hosts by their system_profile.ansible values
  priority: high

inv-hosts-filter-by-system_profile-mssql:
  summary: Filter hosts by MSSQL field
  description: I should be able to filter hosts by their system_profile.mssql values
  priority: high

inv-hosts-filter-by-system_profile-sap:
  summary: Filter hosts by SAP field
  description: I should be able to filter hosts by their system_profile.sap values
  priority: high

inv-hosts-filter-by-system_profile-bootc_status:
  summary: Filter hosts by bootc_status field
  description: >
    BE: I should be able to filter hosts by their system_profile.bootc_status values.
    This gives me ability to get only image-mode hosts.
    FE: I should be able to filter hosts by 'Image-based system' option in "System type" filter .
  priority: high

inv-hosts-filter-by-system_profile-rhel_ai:
  summary: Filter hosts by rhel_ai field
  description: >
    I should be able to filter hosts by their system_profile.rhel_ai values.
  priority: high

inv-hosts-filter-by-insights_id:
  summary: Filter hosts by Insights ID
  description: >
    I should be able to filter hosts by their Insights ID on GET /hosts endpoint via `insights_id` parameter.
    Provided parameter value has to be in UUID format.
  priority: medium

inv-hosts-filter-by-subscription_manager_id:
  summary: Filter hosts by subscription_manager_id
  description: >
    I should be able to filter hosts by their subscription_manager_id on GET /hosts endpoint via `subscription_manager_id` parameter.
    Provided parameter value has to be in UUID format.
  priority: high

inv-hosts-filter-by-provider_id:
  summary: Filter hosts by Provider ID
  description: >
    I should be able to filter hosts by their Provider ID on GET /hosts endpoint via `provider_id` parameter.
  priority: medium

inv-hosts-filter-by-provider_type:
  summary: Filter hosts by Provider Type
  description: >
    I should be able to filter hosts by their Provider Type on GET /hosts endpoint via `provider_type` parameter.
    Provided parameter value has to be one of available values: alibaba, aws, azure, gcp, ibm
  priority: medium

inv-hosts-filter-by-branch_id:
  summary: Filter hosts by branch_id
  description: >
    I should be able to provide `branch_id` parameter on GET /hosts and GET /hosts/<host_id_list> endpoints,
    but it shouldn't do anything.
  priority: low

inv-hosts-get-by-id:
  summary: Get hosts by their Inventory ID
  description: I should be able to get specific hosts on GET /hosts/<host_id_list> endpoint
  priority: critical

inv-hosts-get-system_profile:
  summary: Get system_profile of hosts
  description: >
    BE: I should be able to get system_profile of specific hosts on GET /hosts/<host_id_list>/system_profile endpoint.
    FE: Host's details page displays all required system_profile information.
  priority: critical

inv-hosts-get-tags:
  summary: Get tags of hosts
  description: >
    I should be able to get tags of specific hosts on GET /hosts/<host_id_list>/tags endpoint.
    I can also search for specific tags via `search` parameter
  priority: high

inv-hosts-get-tags-count:
  summary: Get tags count of hosts
  description: I should be able to get count of tags of specific hosts on GET /hosts/<host_id_list>/tags/count endpoint.
  priority: medium

inv-host_exists-get-by-insights-id:
  summary: Check if a host exists using the host_exists endpoint
  description: >
    Call the GET /host_exists endpoint with an insights id to determine if the host exists
  priority: high

inv-hosts-last_check_in-field:
  summary: Check host's 'last_check_in' field
  description: >
    Add 'last_check_in' field to GET /hosts and GET /hosts/<host_id_list> endpoints. 'last_check_in' field holding the latest timestamp
    from all reporters available at per_reporter_staleness for the given host. API clients can also sort by this
    field in ascending or descending order.
  priority: high

inv-hosts-delete-by-id:
  summary: Delete list of hosts
  description: I should be able to delete specific hosts on DELETE /hosts/<host_id_list> endpoint.
  priority: critical

inv-hosts-delete-filtered-hosts:
  summary: Bulk delete of filtered hosts
  description: >
    I should be able to delete hosts in bulk on DELETE /hosts endpoint. I should be able to provide the same filtering
    parameters as to GET /hosts endpoint and it should filter the hosts and delete the same hosts as I would get there.
    At least one parameter should be required, so customers won't accidentally delete all of their hosts.
  priority: high

inv-hosts-delete-all:
  summary: Delete all hosts
  description: >
    I should be able to delete all hosts in the account on DELETE /hosts/all endpoint. It is required to provide
    `confirm_delete_all=True` parameter, so customers won't accidentally delete all of their hosts.
  priority: medium

inv-hosts-patch:
  summary: Update hosts's display name and ansible hostname
  description: >
    BE: I should be able to update `display_name` and/or `ansible_host` of specific hosts
    on PATCH /hosts/<host_id_list> endpoint. The new values should be sent as json data in the request body
    with the header `Content-Type: application/json`. Example data:
    `{"ansible_host": "host1.mydomain.com", "display_name": "host1.mydomain.com"}`
    FE: I should be able to update "Ansible hostname" and "Display name" from Systems page and System details page.
  priority: high

inv-hosts-patch-facts:
  summary: Merge hosts's facts under a namespace
  description: >
    I should be able to update `facts` under already existing namespace of specific hosts
    on PATCH /hosts/<host_id_list>/facts/<namespace> endpoint. The existing keys/values should be merged with new ones,
    so if I don't provide some of the already existing keys, they should be unchanged.
    The new values should be sent as json data in the request body with the header `Content-Type: application/json`.
    Example data: `{"fact1": "value1", "fact2": "value2"}`
  priority: medium

inv-hosts-put-facts:
  summary: Replace hosts's facts under a namespace
  description: >
    I should be able to update `facts` under already existing namespace of specific hosts
    on PUT /hosts/<host_id_list>/facts/<namespace> endpoint. The existing keys/values should be replaced by new ones,
    so if I don't provide some of the already existing keys, they should be removed.
    The new values should be sent as json data in the request body with the header `Content-Type: application/json`.
    Example data: `{"fact1": "value1", "fact2": "value2"}`
  priority: medium

inv-tags-get-list:
  summary: Get tags of filtered hosts
  description: >
    BE: I should be able to get all tags associated to all hosts that match provided parameters
    on GET /tags endpoint. I should be able to provide the same filtering parameters as to GET /hosts endpoint.
    I should also be able to provide `search` parameter that will filter out tags that don't match given string
    in namespace, key or value.
    FE: I should be able see list of tags in "Global tags" filter menu
  priority: high

inv-system_profile-get-sap_sids:
  summary: Get enumeration of sap_sids values for all hosts in account
  priority: high

inv-system_profile-get-sap_system:
  summary: Get enumeration of sap_system values for all hosts in account
  priority: high

inv-system_profile-operating_system:
  summary: Get enumeration of operating_system values for all hosts in account
  priority: high

inv-pagination:
  summary: Setting maximum results per page and page number
  description: >
    I should be able to set maximum desired results returned per page via `per_page`
    parameter and  get the desired results page via `page` parameter on all GET endpoints.
  priority: critical

inv-hosts-sorting:
  summary: Ordering results by direction and by field
  description: >
    BE: I should be able to order results by `display_name`, `updated` timestamp or `operating_system`
    via `order_by` parameter on all GET /hosts* endpoints and GET /tags endpoint.

    I should be able to order results by ascending (`ASC`) or descending (`DESC`) direction via `order_how`
    parameter on all GET /hosts* endpoints and GET /tags endpoint. I can sort hosts without providing order_how
    parameter. The default sorting should be used (ASC for display_name and operating_system, DESC for updated).
    FE: I should be able to sort by Name, Operating system, Workspaces, Last seen columns.
  priority: critical

inv-host-reaper:
  summary: Host reaper should run periodically and delete all hosts that are in culled staleness state
  priority: high

inv-host-reaper-rhsm-sp-bridge-bandaid:
  summary: rhsm-system-profile-bridge hosts shouldn't get culled and the reaper shouldn't delete them
  description: >
    There is an issue in the rhsm-system-profile-bridge workflow where hosts reported only by this
    reporter are not checking-in regularly and they get purged from Inventory by the reaper. As a
    band-aid, Inventory implemented a workaround for hosts which are reported only by
    rhsm-system-profile-bridge. These hosts should not be deleted by the reaper, instead their
    "updated" and "last_check_in" timestamps should get updated to make them fresh again.
    This workaround is temporary until the rhsm-system-profile-bridge workflow gets fixed.
  links:
    - https://issues.redhat.com/browse/RHINENG-16901
    - https://issues.redhat.com/browse/CHAINSAW-408
  priority: high

inv-per-reporter-staleness:
  summary: Store staleness data for each reporter
  description: >
    Inventory should store staleness data for each reporter that updates the host.
    Global `stale_timestamp` should be set after each update by any reporter.
  priority: high

inv-db-schema:
  summary: Inventory should have correct DB schemas for hosts, groups and hosts_groups tables
  description: >
    Inventory should have correct DB schemas for hosts, groups and hosts_groups tables.
    DB schema changes should not break RHSM (the RHSM team has an app that is coupled to a read-only
    copy of the HBI DB. DB query:
    https://github.com/RedHatInsights/rhsm-subscriptions/blob/master/src/main/java/org/candlepin/subscriptions/inventory/db/model/InventoryHost.java#L74-L106 # noqa: E501).
  priority: high

inv-graceful-shutdown:
  summary: Graceful shutdown
  description: >
    All hosts should be created and the proper messages
    should be produced to the events kafka topic even
    if the inventory MQ or API services go down and then back up again
  priority: high

inv-rbac:
  summary: Inventory should make RBAC checks for all API endpoints
  description: >
    BE: When I send an API request, Inventory should check whether I have the rights to access/modify the requested data.
    User has to have read RBAC access to do GET requests and write RBAC access to do PATCH, PUT and DELETE requests.
    If a user has a wildcard (*), he can do both. Inventory should distinct between groups and hosts permissions.

    FE:
    Custom staleness and deletion:
      User with staleness:staleness:write and staleness:staleness:read permissions able to apply custom staleness
      setting to systems.
      User without staleness:staleness:read permission has no access to Staleness And Deletion Page
      User with only staleness:staleness:read permission has access to Staleness And Deletion Page, but not able to modify
      staleness setting to systems.
    Workspaces page:
      Workspaces Administrator Role - user should be able see/edit/create/delete all workspace.
      Workspaces Viewer Role - user should be able only to see all workspaces.
    Systems page:
      Hosts Administrator Role - user should be able see/edit/delete all systems.
      Hosts Viewer Role - user should be able only to see all systems table and system's information.
  priority: critical

inv-rbac-cert-auth-bypass:
  summary: Inventory should bypass RBAC checks for cert-auth API requests
  description: >
    When I send an API request with cert-auth, Inventory should bypass the RBAC checks and should only do
    the cert-auth check (system_profile.owner_id == system.cn)
  priority: high

inv-rbac-granular-groups:
  summary: Inventory should make resource level RBAC checks for Inventory groups
  description: >
    Inventory RBAC permissions can be restricted only to a specific Inventory group.
    Inventory should check these restrictions and allow access only to resources (either group itself or hosts)
    associated with groups specified in an attributeFilter of the required RBAC permission.
  priority: critical

inv-api-cert-auth:
  summary: Cert auth access checking for API endpoints
  description: >
    When using cert auth (sending identity with `auth_type: cert-auth`) on API requests, I can only read/edit/delete
    data of hosts that have `system_profile.owner_id` the same as my `system.cn` in my identity.
  priority: high

inv-host-create:
  summary: Create a new host
  description: >
    I should be able to create a new host in Inventory by sending a kafka message to the
    `platform.inventory.host-ingress` topic. I can set all host fields and system profile fields in the message
    and they should be set in the new host, as long as they are properly formatted and pass the validation.
  priority: critical

inv-host-update:
  summary: Update a host
  description: >
    I should be able to update already existing host in Inventory by sending a kafka message to the
    `platform.inventory.host-ingress` topic. I can set all host fields and system profile fields in the message
    and they should be set in the updated host, as long as they are properly formatted and pass the validation.
  priority: critical

inv-accept-mq-key:
  summary: Accept org_id as a key on incoming kafka messages
  priority: high

inv-host-deduplication:
  summary: Host deduplication
  description: >
    When we send a payload to Inventory that is matching one of the already existing host based on
    deduplication criteria, this host should be updated and a new host should not be created (with
    the exception of culled hosts, in that case, the culled host should be ignored and a new one
    should be created).
    Deduplication is based on ID facts (provider_id, subscription_manager_id, insights_id). The
    provider_id is considered to be immutable, and also it is a compound fact with provider_type.
    This means, that if provider_id or provider_type are included in the payload and they are
    different than these facts on an existing host, this host can't be updated even if all other
    facts are matching and a new host should be created. If the immutable facts are not provided
    in the payload, then it is enough if any of the ID facts are matching the existing host and
    this host should be updated.
  links:
    - https://docs.google.com/document/d/1OOyDaOU9XFKQJHLUbOhlSRsW5u3zgFgwaG7RmaH8bFU/edit?tab=t.0#heading=h.fuf1c0g8fvay
  priority: critical

inv-mq-host-field-validation:
  summary: Validate host fields and  system_profile fields in incoming kafka create/update messages
  priority: high

inv-mq-fields-protection:
  summary: Some host fields (`created`, `updated`, 'last_check_in' and `id`) can't be set manually
  priority: medium

inv-mq-required-fields:
  summary: Host creation/update will fail if required fields are not present in the message
  priority: medium

inv-mq-id-fact-required:
  summary: At least one ID fact is required in create/update kafka message
  priority: medium

inv-provider-fields:
  summary: Both or none of `provider_type` and `provider_id` have to be provided in the create/update kafka message
  priority: medium

inv-mq-canonical-fact:
  summary: At least one canonical fact is required in create/update kafka message
  description: >
    At least one canonical fact is required in create/update kafka message.
    Inventory should transform all canonical facts to lowercase.
  priority: high

inv-remove-zero-mac_address:
  summary: Inventory should remove zero mac address from the payload (00:00:00:00:00:00)
  priority: high

inv-tags:
  summary: Hosts can be tagged
  description: >
    Host creation/update kafka message can include tags and the host should be tagged. The tags can be provided either
    in a list one by one as dictionaries in format: [{"namespace": <namespace>, "key": <key>, "value": <value>}]
    Or, if you want to assign more tags in the same namespace/key, they can be in nested format:
    [{<namespace>: {<key1>: [<value1.1>, <value1.2>], <key2>: [<value2.1>]}}]
    Tags can include special characters. They can be removed by sending an empty namespace.
    When updating tags, all tags on the namespace will be replaced by the new tags.
  priority: high

inv-mq-system-profile-topic:
  summary: I can update host's system_profile via platform.inventory.system-profile kafka topic
  description: >
    I should be able to update host's system_profile by sending kafka message to `platform.inventory.system-profile`
    topic. The message doesn't have to include `platform_metadata`, which means it also doesn't have to
    include identity. The updated host is indicated either by it's Inventory ID, or by the same rules
    the deduplication works.
  priority: high

inv-display_name-fallback:
  summary: HBI will automatically assign display_name when not provided
  description: >
    If a host is created/updated and the display_name is not provided,
    it will be set to fqdn (if fqdn is provided) or host ID
  priority: medium

inv-mq-identity-validation:
  summary: Inventory should validate the identity in the create/update kafka message
  description: >
    All incoming messages have to include base64 encoded identity in the platform_metadata section.
    The identity has to be correctly formatted and has to include all required data.
    If the `identity.type` is `system`, it also needs to include correctly formatted `identity.system.cn`.
    If the `system_profile.owner_id` is provided in the message, it has to match the CN. Otherwise, the `owner_id`
    should be automatically updated to match the CN.
  priority: high

inv-mq-identity-exception-rhsm:
  summary: Identity shouldn't be required for rhsm-conduit and rhsm-system-profile-bridge reporter
  description: >
    If the `reporter` is `rhsm-conduit` or `rhsm-system-profile-bridge` in the incoming kafka message,
    Inventory should bypass the identity check and it should set `system_profile.owner_id`
    to the canonical form of `subscription_manager_id`.
  priority: high

inv-api-identity-validation:
  summary: Inventory should validate the identity header in the API requests
  description: >
    All incoming messages have to include base64 encoded identity header.
    The identity has to be correctly formatted and has to include all required data.
    If the `identity.type` is `system`, it also needs to include correctly formatted `identity.system.cn`.
  priority: high

inv-api-validation:
  summary: Inventory should deny API requests with badly formatted parameters
  priority: low

inv-produce-event-messages:
  summary: Inventory should produce create/update/delete messages
  description: >
    Inventory should produce messages to the `platform.inventory.events` kafka topic after every host
    creation, update or deletion to keep other apps in sync.
  priority: critical

inv-preserve-metadata:
  summary: Preserve platform_metadata from incoming kafka message/ API request to produced events message
  priority: medium

inv-legacy-endpoints:
  summary: Legacy (classic) paths of inventory API should work on PROD
  priority: medium

inv-service-proxy:
  summary: Service proxy works and I can use the old port (8080) for all REST API requests
  priority: medium

inv-metrics:
  summary: I can get Inventory metrics on /metrics endpoint on port 9000
  priority: medium

inv-groups-post:
  summary: Create new group by sending POST request
  description: >
    BE: Create new group by sending POST request.
    FE: I should be able to create workpsace from Workspaces page and Systems page/Add system modal
  priority: high

inv-groups-patch:
  summary: Update existing group by sending PATCH request
  description: >
    BE: Update existing group by sending PATCH request.
    FE: I should be able to rename workspace from Workspaces page and Workspace details page
  priority: high

inv-groups-add-hosts:
  summary: Add hosts to group by sending POST request to /groups/<group_id>/hosts
  description: >
    BE: Add hosts to group by sending POST request to /groups/<group_id>/hosts.
    FE: I should be able to add hosts to workspace from Systems page and Workspace details page.
  priority: high

inv-groups-remove-hosts:
  summary: Remove hosts from group by sending DELETE /groups/{group_id}/hosts/{host_id_list} request
  description: >
    BE: Remove hosts from group by sending DELETE /groups/{group_id}/hosts/{host_id_list} request.
    FE: Remove hosts from workspace in Systems page and Workspace details page.
  priority: high

inv-groups-remove-hosts-multiple-groups:
  summary: Remove hosts from multiple groups by sending DELETE /groups/hosts/{host_id_list} request
  priority: high

inv-groups-delete:
  summary: Delete groups by sending DELETE request
  description: >
    BE: I should be able to delete specific group on DELETE /groups/{group_id_list} endpoint.
    FE: A user should be able to delete empty workspaces. A user not able to delete workspaces with systems.
  priority: high

inv-groups-get-by-id:
  summary: Get groups by their IDs on GET /groups/<groups_ids_list> endpoint
  priority: high

inv-groups-get-list:
  summary: Get a list of groups on GET /groups endpoint
  description: I should be able to filter groups by their name
  priority: high

inv-mq-operation-args:
  summary: I can provide operation_args in MQ create/update message
  priority: high

inv-mq-defer-to-reporter:
  summary: Defer system_profile to different reporter
  description: >
    I can provide "defer_to_reporter" in "operation_args" in MQ update message and Inventory
    should keep system_profile untouched if the provided reporter is fresh
  priority: high


inv-resource-types-list:
  summary: Get a list of all available resource types in Inventory
  priority: high

inv-resource-types-groups:
  summary: Get a list of groups resources in Inventory
  priority: high


inv-staleness-post:
  summary: Set custom staleness settings by sending a POST request
  priority: high

inv-staleness-get-defaults:
  summary: Get custom staleness default settings by sending a GET request
  description: >
    BE: Get custom staleness default settings by sending a GET request
    UI: A user must be able to reset system's staleness setting to default
    settings
  priority: high

inv-staleness-get:
  summary: Get custom staleness settings by sending a GET request
  priority: high

inv-staleness-patch:
  summary: Update custom staleness settings by sending a PATCH request
  description: >
    BE: Update custom staleness settings by sending a PATCH request
    FE: A user must be able to update system's staleness setting
  priority: high

inv-staleness-delete:
  summary: Delete custom staleness settings by sending a DELETE request
  priority: high

inv-staleness-hosts:
  summary: Hosts should change their staleness state after periods of time
  description: >
    Hosts should go through this staleness cycle when they are not updated regularly:
    fresh -> stale -> stale_warning -> culled.
    Hosts are fresh until their stale_timestamp is older than current datetime.
    Then they are stale until their stale_warning_timestamp is older than current datetime.
    Then they are in a stale_warning state until their culled_timestamp is older than current datetime.
    Then they are in a culled state and will be deleted by the next run of host reaper.
    stale_timestamp is set by the reporter when the host is created and is updated each time the host is updated.
    Usually, stale_timestamp is set to 28 hours in the future.
    stale_warning_timestamp is automatically set to stale_timestamp + 7 days.
    culled_timestamp is automatically set to stale_warning_timestamp + 7 days.
    Culled hosts should not be accessible.
  priority: high


inv-cache-invalidation-insights-client:
  summary: Invalidate HBI API cache on insights-client API calls when there is an update in my org
  description: >
    HBI APIs use a longer cache (36 hours) for basic API calls made by insights-client.
    Insights-client makes a lot of GET /hosts?insights_id=... calls before and after the upload,
    so this cache should help increase DB performance. But, if the host with the specified
    insights_id gets updated in between these 2 requests, the cache should get invalidated and the
    second response should include fresh data. We can simulate these insights-client calls by
    using cert-auth and the insights_id parameter on GET /hosts endpoint. This cache is initialized
    when a host checks in via upload.
  priority: high


inv-export-hosts:
  summary: Export hosts by sending a POST request
  description: >
    BE: Export hosts by sending a POST request.
    FE: A user sghould be able to export systems via Export button
  priority: high


inv-notifications-validation-error:
  summary: Inventory should produce validation error notifications
  description: >
    Inventory should produce messages to the `platform.notifications.ingress` kafka topic after
    every unsuccessful host creation or update.
  priority: high

inv-notifications-system-deleted:
  summary: Inventory should produce system-deleted notifications
  description: >
    Inventory should produce messages to the `platform.notifications.ingress` kafka topic after
    every successful host deletion, which will trigger a notification.
  priority: high

inv-notifications-new-system-registered:
  summary: Inventory should produce new-system-registered notifications
  description: >
    Inventory should produce messages to the `platform.notifications.ingress` kafka topic after
    every successful host creation, which will trigger a notification.
  priority: high

inv-notifications-system-became-stale:
  summary: Inventory should produce system-became-stale notifications
  description: >
    Inventory should produce messages to the `platform.notifications.ingress` kafka topic whenever
    a host becomes stale, which will trigger a notification.
  priority: high

inv-kessel-ungrouped:
  summary: Inventory should store ungrouped hosts correctly
  description: Inventory should store ungrouped hosts in the "ungrouped" group
  priority: high

inv-kessel-groups:
  summary: Inventory should propagate group data to kessel workspaces
  description: >
    Inventory should propagate all group-level changes to corresponding Kessel workspaces
  priority: high

inv-kessel-rbac-ungrouped:
  summary: RBAC permissions work correctly for ungrouped hosts
  description: >
    Users can set permissions for ungrouped hosts using the ungrouped group id in a role's resource definition
  priority: high

inv-kessel-workspaces:
  summary: Kessel workspace updates should propagate to Inventory
  description: >
    All Kessel workspace updates should propagate to corresponding Inventory groups
  priority: high

inv-kessel-hosts:
  summary: Host updates should be replicated to Kessel
  description: >
    All updates to HBI hosts (small subset of fields) should be reflected in Kessel.
  priority: high

inv_ui-navigation:
  summary: Navigation works for all Inventory pages
  priority: critical

inv_ui-dashboard:
  summary: Navigation to the Inventory UI via Dashboard links
  priority: critical
  description: >
    A user must be able to reach the Inventory Systems page via Dashboard links.

inv-post-tags-endpoints:
  summary: "POST /tags endpoint can be used to add new tags to a host in Insights on Premise"
  priority: high

inv-system-profile-tables:
  summary: System Profile data can be stored in new tables and JSONB column
  priority: high
  description: >
    System Profile data can be stored in new tables both system_profiles_static,
    system_profiles_dynamic tables and JSONB column

inv-rhsm-display_name:
  summary: HBI should ignore display_name updates from RHSM if it's been set by insights-client or UI
  description: >
    RHSM reporters (rhsm-conduit and rhsm-system-profile-bridge) overwrite the display_name that is
    set explicitly by a user via insights-client or UI. rhsm-conduit does this during the nightly
    uploads, while rhsm-system-profile-bridge does this during the registration. HBI needs to
    ignore these updates if the display_name has been already set by a user.
  priority: high
  links:
    - https://issues.redhat.com/browse/RHINENG-19514
    - https://issues.redhat.com/browse/RHINENG-20429
